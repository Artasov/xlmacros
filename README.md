# xLMacros docs

- [Синтаксис](https://github.com/ChaiScript/ChaiScript/blob/develop/cheatsheet.md#language-reference)
- [Функции](#Функции)
  - [Разное](#Разное)
  - [Клавиатура и мышь](#Клавиатура-и-мышь)
  - [Ожидание](#Ожидание)
  - [Поиск на экране](#Поиск-на-экране)
- [Список клавиш](#Список-клавиш)
- [Примеры скриптов](#Примеры-скриптов)

## Функции

### Разное
```js
log(value: any)
    Записывает переданное значение в журнал.
    value: Значение для записи в журнал.
```
```js
playMp3(mp3_path: str)
    Воспроизводит mp3 файл по указанному пути.
    mp3_path: Путь к mp3.
```
```js
randomInt() -> int 
    Возвращает случайное целое число.
```
```js
randomIntR(min: int, max: int) -> int 
    Возвращает случайное целое число в диапозоне.
    min: Нижняя граница.
    max: Верхняя граница.
```
```js
cmd(commands: str) -> str 
    Выполняет комнады в консоли windows и возвращает вывод.
```
```js
cmdD(commands: str)
    Выполняет комнады в консоли windows в фоновом режиме detached (multiprocess).
```

### Клавиатура и мышь
```js
click(key_name: str)
    Имитирует нажатие указанной клавиши.
    key_name: Имя клавиши для нажатия.
```
```js
clickTo(key_name: str, x: int, y: int)
    Имитирует нажатие указанной клавиши в заданных координатах.
    key_name: Имя клавиши для нажатия.
    x: Координата x.
    y: Координата y.
```
```js
typeText(text: str, delay_ms: int)
    Имитирует ввод текста с заданной задержкой между символами.
    text: Текст для ввода.
    delay_ms: Задержка между символами в миллисекундах.
```
```js
moveRel(x: int, y: int, duration: int)
    Перемещает курсор относительно текущего положения.
    x: Координата x.
    y: Координата y.
    duration: продолжительность перемещения в миллисекундах.
```
```js
moveRelS(x: int, y: int, steps: int, duration: int)
    Перемещает курсор относительно текущего положения с разбиением на шаги.
    x: Координата x.
    y: Координата y.
    steps: Количество шагов перемещения.
    duration: Продолжительность перемещения в миллисекундах.
```
```js
moveTo(x: int, y: int, duration: int)
    Перемещает курсор в заданные координаты экрана.
    x: Координата x.
    y: Координата y.
    duration: продолжительность перемещения в миллисекундах.
```
```js
press(key_name: str)
    Имитирует нажатие указанной клавиши без её отпускания.
    key_name: Имя клавиши для нажатия.
```
```js
release(key_name: str)
    Имитирует отпускание ранее нажатой клавиши.
    key_name: имя клавиши для отпускания.
```
```sh
LMBClick() Клик левой кнопкой мыши.
```
```sh
MMBClick() Клик средней кнопкой мыши.
```
```sh
RMBClick() Клик правой кнопкой мыши.
```
```sh
LMBPress() Нажатие левой кнопкой мыши без её отпускания.
```
```sh
MMBPress() Нажатие средней кнопкой мыши без её отпускания.
```
```sh
RMBPress() Нажатие правой кнопкой мыши без её отпускания.
```
```sh
LMBRelease() Отпускание левой кнопки мыши.
```
```sh
MMBRelease() Отпускание средней кнопки мыши.
```
```sh
RMBRelease() Отпускание правой кнопки мыши.
```



### Ожидание

```js
tmsleep(ms: int)
    Приостанавливает выполнение программы на заданное время в миллисекундах.
    ms: время паузы в миллисекундах.
```
```js
symsleep(ms: int)
    Приостанавливает выполнение программы на заданное время в миллисекундах 
    с учетом симуляции.
    ms: время паузы в миллисекундах.
```


### Поиск на экране
```js
clickToImageC(key_name: str, image_path: str, accuracy: float)
    Имитирует нажатие клавиши на указанном изображении с заданной точностью.
    key_name: имя клавиши для нажатия.
    image_path: путь к изображению.
    accuracy: уровень точности поиска изображения 0.00 <= accuracy <= 1.00.
```
```js
waitImage(
    image_path: str, check_interval: int, 
    timeout: int, accuracy: float
)
    Ожидает появление изображения на экране в течение заданного времени.
    image_path: путь к изображению.
    check_interval: интервал проверки появления изображения в миллисекундах.
    timeout: максимальное время ожидания в миллисекундах.
    accuracy: уровень точности поиска изображения 0.00 <= accuracy <= 1.00.
```
```js
findImage(image_path: str, accuracy: float) -> Point(x, y)
    Ищет изображение на экране и возвращает координаты его центра.
    image_path: путь к изображению.
    accuracy: уровень точности поиска изображения 0.00 <= accuracy <= 1.00.
```
```js
findImageC(image_path: str, accuracy: float) -> Point(x, y)
    Ищет изображение на текущем активном окне и возвращает координаты 
    его центра.
    image_path: путь к изображению.
    accuracy: уровень точности поиска изображения 0.00 <= accuracy <= 1.00.
```
```js
findImageW(
    image_path: str, check_interval: int, 
    timeout: int, accuracy: float
) -> Point(x, y)
    Ищет изображение на экране в течение заданного времени и возвращает 
    координаты его центра.
    image_path: путь к изображению.
    check_interval: интервал проверки появления изображения в миллисекундах.
    timeout: максимальное время ожидания в миллисекундах.
    accuracy: уровень точности поиска изображения 0.00 <= accuracy <= 1.00.
```
```js
findImageWC(
    image_path: str, check_interval: int, 
    timeout: int, accuracy: float
) -> Point(x, y)
    Ищет изображение на текущем активном окне в течение заданного 
    времени и возвращает координаты его центра.
    image_path: путь к изображению.
    check_interval: интервал проверки появления изображения в миллисекундах.
    timeout: максимальное время ожидания в миллисекундах.
    accuracy: уровень точности поиска изображения 0.00 <= accuracy <= 1.00.
```
```js
findImages(image_path: str, accuracy: float) -> Point(x, y)
    Ищет все экземпляры указанного изображения на экране и 
    возвращает их координаты.
    image_path: путь к изображению.
    accuracy: уровень точности поиска изображений 0.00 <= accuracy <= 1.00.
```
```js
findImagesC(image_path: str, accuracy: float) -> Point(x, y)
    Ищет все экземпляры указанного изображения на текущем активном 
    окне и возвращает их координаты.
    image_path: путь к изображению.
    accuracy: уровень точности поиска изображений 0.00 <= accuracy <= 1.00.
```
```js
findColor(color: str, accuracy: float) -> Point(x, y)
    Ищет указанный цвет на экране и возвращает координаты его 
    первого вхождения.
    color: искомый цвет в формате строки.
    accuracy: уровень точности поиска цвета 0.00 <= accuracy <= 1.00
```

## Список клавиш
```js
'ESC': 27
'F1': 112
'F2': 113
'F3': 114
'F4': 115
'F5': 116
'F6': 117
'F7': 118
'F8': 119
'F9': 120
'F10': 121
'F11': 122
'F12': 123
'PS': 44
'SCROLL': 145
'CBP': 3
'`': 192
'1': 49
'2': 50
'3': 51
'4': 52
'5': 53
'6': 54
'7': 55
'8': 56
'9': 57
'0': 48
'-': 189
'=': 187
'BS': 8
'INS': 45
'HOME': 36
'PU': 33
'NUMLOCK': 144
'Div /': 111
'Mul *': 106
'Add -': 109
'TAB': 9
'Q': 81
'W': 87
'E': 69
'R': 82
'T': 84
'Y': 89
'U': 85
'I': 73
'O': 79
'P': 80
'[': 219
']': 221
'\\': 220
'DEL': 46
'END': 35
'PD': 34
'Add 7': 103
'Add 8': 104
'Add 9': 105
'Add +': 107
'CAPS': 20
'A': 65
'S': 83
'D': 68
'F': 70
'G': 71
'H': 72
'J': 74
'K': 75
'L': 76
':': 186
"'": 222
'ENTER': 13
'Add 4': 100
'Add 5': 101
'Add 6': 102
'SHIFT': 160
'RSHIFT': 161
'Z': 90
'X': 88
'C': 67
'V': 86
'B': 66
'N': 78
'M': 77
',': 188
'.': 190
'/': 191
'Up': 38
'Add 1': 97
'Add 2': 98
'Add 3': 99
'CTRL': 162
'RCTRL': 163
'Win L': 91
'ALT': 164
'RALT': 165
'SPACE': 32
'Win R': 92
'CMenu': 93
'Left': 37
'Down': 40
'Right': 39
'Add 0': 96
'Dot .': 110
'LB': 1
'RB': 2
'MB': 4
'X1': 5
'X2': 6
'~': 192
```

## Примеры скриптов

```js
// Привет, я комментарий.
// Так мы будет объявлять переменные. 
// var значит, что у тебя короткий.
var ure_iq = 20 
// Или, что мы объявляем переменную.
// А так мы можем их переопредe.лять...
ure_iq = 30 * 2 / 4 + 38 * (666 * 999)
// Так мы залогируем переменную в журнал.
log(ure_iq)
// Отнимаем от самого себя.
ure_iq -= 999 * 999

var a = 666
var success = "success"
var warning = "warning"
if(3 <= 4){
   a = 4
   while(0 != a){
      // Эта функция проигрывает предустановленный звук.
      // Все функции перечислены в гайде.
      // Название берется из переменной success,
      // которую мы объявили ранее.
      sound(success)
      // Двигаем курсор на 875 пикселей
      // в лево пошагово в течении 400ms.
      // Для меня это было 90 градусов в игре :)
      moveRelS(0, 1000, 15, 1400)
      // Клик ЛКМ
      LMBClick()
      // Уменьшаем 'a' на 1.
      a -= 1
   } 
} else {
   sound(warning)
}
// Супер! А теперь иди читай доку...
```
```js
// Пользуемся датами
// Date init
var date1 = Date("1971-07-21 00:00:00")
log("Созданная дата: " + date1.toString())
// Date now
var date2 = Date()
log("Сейчас: " + date2.toString())
// Date increasing & decreasing
var date3 = date2.iDays(5).iHours(3).iMinutes(30).dSeconds(5);
log("Посчитанная дата: "+date3.toString())
// Difference of dates
var secondsDiff = date2 - date1;
log(addStrNum("Разница: ", secondsDiff))
// Parse Seconds to Years => double
log(secToYears(secondsDiff))

```
```js
// Ищем цвет на экране
var pos = findColor("#ff002a", 1)
log(pos)
moveTo(pos.x, pos.y, 0)
```